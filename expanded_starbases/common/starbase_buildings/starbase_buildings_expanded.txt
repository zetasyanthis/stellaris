# Vanilla Buildings
hydroponics_bay = {
	icon = "GFX_spaceport_module_hydroponic_farms"
	construction_days = 180
	
	potential = {
		exists = owner
		owner = { has_technology = "tech_hydroponics" }
	}

	resources = {
		category = starbase_buildings
		cost = {
			alloys = 50
		}

		produces = {
			food = 3
			trigger = {
				NOT = { owner = { has_technology = "tech_advanced_orbital_hydroponics" } }
			}
		}
		
		produces = {
			food = 5
			trigger = {
				owner = { has_technology = "tech_advanced_orbital_hydroponics" }	
			}
		}

		upkeep = {
			energy = 1
		}
	}
	
	show_in_tech = "tech_hydroponics"

	ai_build_at_chokepoint = no
	ai_build_outside_chokepoint = yes
	ai_weight = {
		weight = 50
	}
}

offworld_trading_company = {
	icon = "GFX_starbase_offworld_trading_company"
	construction_days = 360

	
	potential = {
		exists = owner
		owner = {
			has_technology = tech_space_trading
			is_gestalt = no
		}
	}	
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
		has_starbase_module = trading_hub
	}

	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}
	}
	
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 1
			}
			count_starbase_modules = {
				type = trading_hub
				count < 2
			}			
		}
		
		trade_value_add = 2
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 2
			}
			count_starbase_modules = {
				type = trading_hub
				count < 3
			}			
		}
		
		trade_value_add = 4
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 3
			}
			count_starbase_modules = {
				type = trading_hub
				count < 4
			}		
		}
		
		trade_value_add = 6
	}	
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 4
			}
			count_starbase_modules = {
				type = trading_hub
				count < 5
			}			
		}
		
		trade_value_add = 8
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 5
			}
			count_starbase_modules = {
				type = trading_hub
				count < 6
			}			
		}
		
		trade_value_add = 10
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 6
			}
			count_starbase_modules = {
				type = trading_hub
				count < 7
			}
		}
		
		trade_value_add = 12
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 7
			}
			count_starbase_modules = {
				type = trading_hub
				count < 8
			}
		}
		
		trade_value_add = 14
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 8
			}
			count_starbase_modules = {
				type = trading_hub
				count < 9
			}
		}
		
		trade_value_add = 16
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 9
			}
			count_starbase_modules = {
				type = trading_hub
				count < 10
			}
		}
		
		trade_value_add = 18
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 10
			}
			count_starbase_modules = {
				type = trading_hub
				count < 11
			}
		}
		
		trade_value_add = 20
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 11
			}
			count_starbase_modules = {
				type = trading_hub
				count < 12
			}
		}
		
		trade_value_add = 22
	}
	triggered_station_modifier = {
		potential = {
			owner = { NOT = { has_technology = "tech_galactic_trading_companies" } }
			count_starbase_modules = {
				type = trading_hub
				count >= 12
			}
		}
		
		trade_value_add = 24
	}
	
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 1
			}
			count_starbase_modules = {
				type = trading_hub
				count < 2
			}			
		}
		
		trade_value_add = 4
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 2
			}
			count_starbase_modules = {
				type = trading_hub
				count < 3
			}			
		}
		
		trade_value_add = 8
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 3
			}
			count_starbase_modules = {
				type = trading_hub
				count < 4
			}		
		}
		
		trade_value_add = 12
	}	
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 4
			}
			count_starbase_modules = {
				type = trading_hub
				count < 5
			}			
		}
		
		trade_value_add = 16
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 5
			}
			count_starbase_modules = {
				type = trading_hub
				count < 6
			}			
		}
		
		trade_value_add = 20
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 6
			}
			count_starbase_modules = {
				type = trading_hub
				count < 7
			}
		}
		
		trade_value_add = 24
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 7
			}
			count_starbase_modules = {
				type = trading_hub
				count < 8
			}
		}
		
		trade_value_add = 28
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 8
			}
			count_starbase_modules = {
				type = trading_hub
				count < 9
			}
		}
		
		trade_value_add = 32
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 9
			}
			count_starbase_modules = {
				type = trading_hub
				count < 10
			}
		}
		
		trade_value_add = 36
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 10
			}
			count_starbase_modules = {
				type = trading_hub
				count < 11
			}
		}
		
		trade_value_add = 40
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 11
			}
			count_starbase_modules = {
				type = trading_hub
				count < 12
			}
		}
		
		trade_value_add = 44
	}
	triggered_station_modifier = {
		potential = {
			owner = { has_technology = "tech_galactic_trading_companies" }
			count_starbase_modules = {
				type = trading_hub
				count >= 12
			}
		}
		
		trade_value_add = 48
	}

	custom_tooltip = sm_offworld_trading_company_desc_modifier

	show_in_tech = "tech_space_trading"
	
	ai_build_at_chokepoint = no
	ai_build_outside_chokepoint = yes
	ai_weight = {
		weight = 200
		modifier = {
			factor = 0
			count_starbase_modules = {
				type = trading_hub
				count < 3
			}
		}
	}
}

target_uplink_computer = {
	icon = "GFX_spaceport_synchronized_defenses"
	construction_days = 360

	potential = {
		exists = owner
	}		
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
	}

	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}

		upkeep = {
			energy = 2
		}
	}

	station_modifier = {
		ship_weapon_range_mult = 0.50
		ship_tracking_add = 5
	}

	ai_build_at_chokepoint = yes
	ai_build_outside_chokepoint = no
	ai_weight = {
		weight = 10
	}
}

defense_grid = {
	icon = "GFX_starbase_defense_grid_supercomputer"
	construction_days = 360

	potential = {
		exists = owner
		owner = { has_technology = tech_synchronized_defences }
	}		
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
	}

	resources = {
		category = starbase_buildings
		cost = {
			alloys = 150
		}

		upkeep = {
			energy = 2
		}
	}

	station_modifier = {
		starbase_defense_platform_capacity_add = 10
	}

	show_in_tech = "tech_synchronized_defences"
	
	ai_build_at_chokepoint = yes
	ai_build_outside_chokepoint = no
	ai_weight = {
		weight = 10
	}
}


black_hole_observatory = {
	icon = "GFX_spaceport_module_observatory"
	construction_days = 360
	
	potential = {
		exists = owner
		owner = { has_technology = tech_sensors_3 }
	}		
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
		custom_tooltip = {
			fail_text = "requires_black_hole"
			OR = {
				star = { is_star_class = sc_black_hole }
				solar_system = { any_planet = { is_planet_class = pc_black_hole } }
				solar_system = { has_natural_wormhole = yes }
			}
		}
	}

	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}

		produces = {
			physics_research = 10
		}

		upkeep = {
			energy = 2
		}
	}

	show_in_tech = "tech_sensors_3"
	
	ai_build_at_chokepoint = no
	ai_build_outside_chokepoint = yes
	ai_weight = {
		weight = 150
	}
}

nebula_refinery = {
	icon = "GFX_spaceport_nebula_refinery"
	construction_days = 360
	
	potential = {
		exists = owner
		owner = { has_technology = tech_space_mining_1 }
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
		custom_tooltip = {
			fail_text = "requires_nebula"
			OR = {
				star = { is_inside_nebula = yes }
				solar_system = {
					OR = {
						# Nebula
						is_star_class = sc_p_purple
						is_star_class = sc_p_green
						is_star_class = sc_p_red
						is_star_class = sc_nova_1
						is_star_class = sc_nova_2
						is_star_class = sc_w_azure
						is_star_class = sc_w_red
						is_star_class = sc_w_green
						is_star_class = sc_w_purple
						is_star_class = sc_lbv_blue
						is_star_class = sc_lbv_green
						is_star_class = sc_lbv_red
						# Protoplanetary Disks
						is_star_class = sc_protostar
						is_star_class = sc_tt_red
						is_star_class = sc_tt_orange
						is_star_class = sc_tt_white
						is_star_class = sc_ae
					}
				}
			}
		}
	}

	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}

		produces = {
			minerals = 6
		}

		upkeep = {
			energy = 2
		}
	}

	show_in_tech = "tech_space_mining_1"
	
	ai_build_at_chokepoint = yes
	ai_build_outside_chokepoint = yes
	ai_weight = {
		weight = 150
	}
}

# New Buildings
pulsar_hole_observatory = {
	icon = "GFX_spaceport_module_observatory"
	construction_days = 360
	
	potential = {
		exists = owner
		owner = { has_technology = tech_sensors_3 }
	}		
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
		custom_tooltip = {
			fail_text = "requires_pulsar"
			star = {
				OR = {
					is_star_class = sc_pulsar
					is_star_class = sc_magnetar
				}
			}
		}
	}

	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}

		produces = {
			engineering_research = 10
		}

		upkeep = {
			energy = 2
		}
	}

	show_in_tech = "tech_sensors_3"
	
	ai_build_at_chokepoint = no
	ai_build_outside_chokepoint = yes
	ai_weight = {
		weight = 150
	}
}

protostar_observatory = {
	icon = "GFX_spaceport_module_observatory"
	construction_days = 360
	
	potential = {
		exists = owner
		owner = { has_technology = tech_sensors_2 }
	}		
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
		custom_tooltip = {
			fail_text = "requires_protostar"
			star = {
				OR = {
					is_star_class = sc_protostar
					is_star_class = sc_tt_red
					is_star_class = sc_tt_orange
					is_star_class = sc_tt_white
					is_star_class = sc_ae
				}
			}
		}
	}

	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}

		produces = {
			physics_research = 8
		}

		upkeep = {
			energy = 2
		}
	}

	show_in_tech = "tech_sensors_2"
	
	ai_build_at_chokepoint = no
	ai_build_outside_chokepoint = yes
	ai_weight = {
		weight = 150
	}
}

#climate_control = {
#	icon = "GFX_spaceport_module_orbital_mind_control_lazer"
#	construction_days = 360
#	
#	potential = {
#		exists = owner
#		owner = { 
#			has_technology = tech_terrestrial_sculpting
#		}
#	}
#	
#	possible = {
#		custom_tooltip = {
#			fail_text = "requires_starport"
#			has_starbase_size >= starbase_starport
#		}
#		custom_tooltip = {
#			fail_text = "requires_colonized_planet"
#			solar_system = {
#				any_planet = {
#					is_owned_by = from
#				}
#			}
#		}
#	}
#	
#	resources = {
#		category = starbase_buildings
#		cost = {
#			alloys = 100
#		}
#
#		upkeep = {
#			energy = 4
#		}
#	}
#	
#	system_modifier = {
#		planet_jobs_food_produces_mult = 0.20 
#		pop_environment_tolerance = 0.15
#	}
#	
#	show_in_tech = "tech_terrestrial_sculpting"
#	
#	ai_build_at_chokepoint = no
#	ai_build_outside_chokepoint = yes
#	ai_weight = {
#		weight = 0
#		modifier = {
#			weight = 100
#			SOLAR_SYSTEM = {
#				OR = {
#					any_planet = {
#						is_owned_by = from 
#						is_colony = yes
#						habitability = { who = from.species value < 0.90 }
#					}
#					count_planets = {
#						limit = {
#							is_owned_by = from 
#							is_colony = yes
#						}
#						count > 1 
#					}
#				}
#			}
#		}
#	}
#}

customs_office = {
	icon = "GFX_starbase_offworld_trading_company"
	construction_days = 360
	
	potential = {
		exists = owner
		owner = { 
			is_gestalt = no
			is_criminal_syndicate = no
			has_technology = tech_adaptive_bureaucracy
		}
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
		custom_tooltip = {
			fail_text = "requires_neighbor_with_open_borders"
			SOLAR_SYSTEM = {
				any_neighbor_system = {
					exists = space_owner
					space_owner = {
						NOT = { is_same_value = from }
						OR = {
							has_commercial_pact = from
							FROM = { is_overlord_to = PREV }
							is_in_federation_with = FROM
						}
					}
				}
			}
		}
	}
	
	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}
		
		produces = {
			society_research = 2
		}

		upkeep = {
			energy = 1
		}
	}
	
	station_modifier = {
		starbase_trade_collection_range_add = 1
		starbase_trade_protection_range_add = 1
		trade_value_add = 2
	}
	
	show_in_tech = "tech_adaptive_bureaucracy"
	
	ai_build_at_chokepoint = yes
	ai_build_outside_chokepoint = yes
	ai_weight = {
		weight = 100
	}
}

customs_office_criminal = {
	icon = "GFX_starbase_offworld_trading_company"
	construction_days = 360
	
	potential = {
		exists = owner
		owner = { 
			is_criminal_syndicate = yes
			has_technology = tech_adaptive_bureaucracy
		}
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
		custom_tooltip = {
			fail_text = "requires_neighbor_not_gestalt"
			SOLAR_SYSTEM = {
				any_neighbor_system = {
					exists = space_owner
					space_owner = {
						NOT = { is_same_value = from }
						OR = {
							any_owned_planet = {
								has_branch_office = yes
								branch_office_owner = { is_same_value = from }
							}
							FROM = { is_overlord_to = PREV }
							is_in_federation_with = FROM
						}
						is_gestalt = no
					}
				}
			}
		}
	}
	
	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}

		upkeep = {
			energy = 1
		}
	}
	
	station_modifier = {
		starbase_trade_collection_range_add = 1
		starbase_trade_protection_range_add = 1
		trade_value_add = 4
	}
	
	show_in_tech = "tech_adaptive_bureaucracy"
	
	ai_build_at_chokepoint = yes
	ai_build_outside_chokepoint = yes
	ai_weight = {
		weight = 100
	}
}

starbase_fortifications = {
	icon = "GFX_starbase_anchorage"
	construction_days = 360
	
	potential = {
		exists = owner
		owner = { 
			has_technology = tech_starbase_hull_1
		}
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_starport"
			has_starbase_size >= starbase_starport
		}
	}
	
	resources = {
		category = starbase_buildings
		cost = {
			alloys = 100
		}

		upkeep = {
			energy = 1
		}
	}
	
	station_modifier = {
		ship_armor_mult = 0.25
		ship_shield_mult = 0.25
	}
	
	show_in_tech = "tech_starbase_hull_1"
	
	ai_build_at_chokepoint = yes
	ai_build_outside_chokepoint = no
	ai_weight = {
		weight = 100
	}
}